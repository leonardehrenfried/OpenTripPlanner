<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://docs.opentripplanner.org/2.0/Configuration/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Configuration - OpenTripPlanner 2</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../css/version-select.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">OpenTripPlanner 2</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Governance/" class="dropdown-item">Governance</a>
</li>
                                    
<li>
    <a href="../History/" class="dropdown-item">History</a>
</li>
                                    
<li>
    <a href="../Deployments/" class="dropdown-item">Deployments</a>
</li>
                                    
<li>
    <a href="../Changelog/" class="dropdown-item">Changelog</a>
</li>
                                    
<li>
    <a href="../Version-Comparison/" class="dropdown-item">Choosing OTP2 or OTP1</a>
</li>
                                    
<li>
    <a href="../OTP2-MigrationGuide/" class="dropdown-item">OTP2 migration guide</a>
</li>
                                    
<li>
    <a href="../Visual-Identity/" class="dropdown-item">Visual Identity</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Usage <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Basic-Tutorial/" class="dropdown-item">Basic Tutorial</a>
</li>
                                    
<li>
    <a href="../Getting-OTP/" class="dropdown-item">Getting OTP</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Configuration</a>
</li>
                                    
<li>
    <a href="../Preparing-OSM/" class="dropdown-item">Preparing OSM Data</a>
</li>
                                    
<li>
    <a href="../Netex-Norway/" class="dropdown-item">Netex and SIRI</a>
</li>
                                    
<li>
    <a href="../Security/" class="dropdown-item">Security</a>
</li>
                                    
<li>
    <a href="../Troubleshooting-Routing/" class="dropdown-item">Troubleshooting</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Development <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Developers-Guide/" class="dropdown-item">Developers' Guide</a>
</li>
                                    
<li>
    <a href="../Interfaces-Data-Sources/" class="dropdown-item">Interfaces and Data Sources</a>
</li>
                                    
<li>
    <a href="../Localization/" class="dropdown-item">Localization</a>
</li>
                                    
<li>
    <a href="../Bibliography/" class="dropdown-item">Bibliography</a>
</li>
                                    
<li>
    <a href="../Codestyle/" class="dropdown-item">Codestyle</a>
</li>
                                    
<li>
    <a href="../SandboxExtension/" class="dropdown-item">Sandbox development</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Sandbox <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../sandbox/HealthAPI/" class="dropdown-item">Health API</a>
</li>
                                    
<li>
    <a href="../sandbox/transferanalyzer/" class="dropdown-item">Direct transfer analyzer</a>
</li>
                                    
<li>
    <a href="../sandbox/GoogleCloudStorage/" class="dropdown-item">Google Cloud Storage</a>
</li>
                                    
<li>
    <a href="../sandbox/LegacyGraphQLApi/" class="dropdown-item">HSL Legacy GraphQL API</a>
</li>
                                    
<li>
    <a href="../sandbox/TransmodelApi/" class="dropdown-item">Transmodel(NeTEx) GrpahQL API</a>
</li>
                                    
<li>
    <a href="../sandbox/SiriUpdator/" class="dropdown-item">SIRI Updater</a>
</li>
                                    
<li>
    <a href="../sandbox/BikeRentalServiceDirectory/" class="dropdown-item">Bike Rental Service Directory API support</a>
</li>
                                    
<li>
    <a href="../sandbox/Examples/" class="dropdown-item">Sandbox Extension Example</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../Getting-OTP/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Preparing-OSM/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="http://github.com/opentripplanner/OpenTripPlanner/edit/master/docs/Configuration.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#configuring-opentripplanner" class="nav-link">Configuring OpenTripPlanner</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#base-directory" class="nav-link">Base Directory</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#three-scopes-of-configuration" class="nav-link">Three Scopes of Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#configuration-types" class="nav-link">Configuration types</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#system-wide-configuration" class="nav-link">System-wide Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#graph-build-configuration" class="nav-link">Graph Build Configuration</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#storage" class="nav-link">Storage</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#limit-the-transit-service-period" class="nav-link">Limit the transit service period</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#reaching-a-subway-platform" class="nav-link">Reaching a subway platform</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#transferring-within-stations" class="nav-link">Transferring within stations</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#elevation-data" class="nav-link">Elevation data</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#fares-configuration" class="nav-link">Fares configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#osm-openstreetmap-configuration" class="nav-link">OSM / OpenStreetMap configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#router-configuration" class="nav-link">Router configuration</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#routing-defaults" class="nav-link">Routing defaults</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#tuning-itinerary-filtering" class="nav-link">Tuning itinerary filtering</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#boarding-and-alighting-times" class="nav-link">Boarding and alighting times</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#timeout" class="nav-link">Timeout</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#logging-incoming-requests" class="nav-link">Logging incoming requests</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#tuning-transit-routing" class="nav-link">Tuning transit routing</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#real-time-data" class="nav-link">Real-time data</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#configure-using-command-line-arguments" class="nav-link">Configure using command-line arguments</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="configuring-opentripplanner">Configuring OpenTripPlanner</h1>
<p><em>Note: if you are familiar with OTP1 configuration and are migrating to OTP2, please read the 
<a href="../OTP2-MigrationGuide/">OTP2 Migration Guide</a> to learn what has changed.</em></p>
<h2 id="base-directory">Base Directory</h2>
<p>On the OTP2 command line you must always specify a single directory after all the switches. This tells OTP2 where to look for any configuration files. By default OTP will also scan this directory for input files to build a graph (GTFS, OSM, elevation, and base street graphs) or the <code>graph.obj</code> file to load when starting a server.</p>
<p>A typical OTP2 directory for a New York City graph might include the following:</p>
<pre><code>otp-config.json
build-config.json
router-config.json
new-york-city-no-buildings.osm.pbf
nyc-elevation.tiff
long-island-rail-road.gtfs.zip
mta-new-york-city-transit.gtfs.zip
port-authority-of-new-york-new-jersey.gtfs.zip
graph.obj
</code></pre>
<p>You could have more than one of these directories if you are building separate graphs for separate regions. Each one should contain one or more GTFS feeds, a PBF OpenStreetMap file, some JSON configuration files, and any output files such as <code>graph.obj</code>. For convenience, especially if you work with only one graph at a time, you may want to place your OTP2 JAR file in this same directory. Note that file types are detected through a case-insensitive combination of file extension and words within the file name. GTFS file names must end in <code>.zip</code> and contain the letters <code>gtfs</code>, and OSM files must end in <code>.pbf</code>.</p>
<p>It is also possible to provide a list of input files in the configuration, which will override this default behavior of scanning the base directory for input files. Scanning is overridden independently for each file type, and can point to remote cloud storage with arbitrary URIs. See <a href="./#Storage">the storage section</a> for further details. </p>
<h2 id="three-scopes-of-configuration">Three Scopes of Configuration</h2>
<p>OTP is configured via three configuration JSON files which are read from the directory specified on its command line. We try to provide sensible defaults for every option, so all three of these files are optional, as are all the options within each file. Each configuration file corresponds to options that are relevant at a particular phase of OTP usage. </p>
<p>Options and parameters that are taken into account during the graph building process will be "baked into" the graph, and cannot be changed later in a running server. These are specified in <code>build-config.json</code>. Other details of OTP operation can be modified without rebuilding the graph. These run-time configuration options are found in <code>router-config.json</code>. Finally, <code>otp-config.json</code> contains simple switches that enable or disable system-wide features. </p>
<h2 id="configuration-types">Configuration types</h2>
<p>The OTP configuration files use the JSON file format. OTP allows comments and unquoted field names 
in the JSON configuration files to be more human-friendly. OTP supports all the basic JSON types: 
nested objects <code>{...}</code>, arrays <code>[]</code>, numbers <code>789.0</code> and boolean <code>true</code> or <code>false</code>. In addition to 
these basic types some configuration parameters are parsed with some restrictions. In the 
documentation below we will refer to the following types:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td>This is the Boolean JSON type.</td>
<td><code>true</code> or <code>false</code></td>
</tr>
<tr>
<td>number</td>
<td>This is the Number JSON type.</td>
<td><code>1</code>, <code>5</code>, <code>3.14</code></td>
</tr>
<tr>
<td>string</td>
<td>A quoted string. This is the String JSON type.</td>
<td><code>"This is a string!"</code></td>
</tr>
<tr>
<td><em>Type</em>[]</td>
<td>Array of of given Type. This is the Array JSON type.</td>
<td><code>[ 1, 2, 3 ]</code></td>
</tr>
<tr>
<td>double</td>
<td>A decimal floating point <em>number</em>. 64 bit.</td>
<td><code>3.14</code></td>
</tr>
<tr>
<td>integer</td>
<td>A decimal integer <em>number</em>. 32 bit.</td>
<td><code>1</code>, <code>-7</code>, <code>2100200300</code></td>
</tr>
<tr>
<td>long</td>
<td>A decimal integer <em>number</em>. 64 bit.</td>
<td><code>-1234567890123456789</code></td>
</tr>
<tr>
<td>enum</td>
<td>A fixed set of string literals.</td>
<td>BicycleOptimize: <code>"QUICK"</code>, <code>"SAFE"</code> ...</td>
</tr>
<tr>
<td>enum-map</td>
<td>List of key/value pairs, where the key is a enum and the value can be any given type.</td>
<td><code>{ RAIL: 1.2, BUS: 2.3 }</code></td>
</tr>
<tr>
<td>enum-set</td>
<td>List of enum string values</td>
<td><code>[ "RAIL", "TRAM" ]</code></td>
</tr>
<tr>
<td>locale</td>
<td><em><code>Language[\_country[\_variant]]</code></em>. A Locale object represents a specific geographical, political, or cultural region. For more information see the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Locale.html">Java 11 Locale</a>.</td>
<td><code>en_US</code>, <code>nn_NO</code></td>
</tr>
<tr>
<td>date</td>
<td>Local date. The format is <em>YYYY-MM-DD</em> (ISO-8601).</td>
<td><code>2020-09-21</code></td>
</tr>
<tr>
<td>date or period</td>
<td>A <em>local date</em>, or a <em>period</em> relative to today. The local date has the format <code>YYYY-MM-DD</code> and the period has the format <code>PnYnMnD</code> or <code>-PnYnMnD</code> where <code>n</code> is a integer number.</td>
<td><code>P1Y</code> is one year from now, <code>-P3M2D</code> means 3 months and 2 days ago, and <code>P1D</code> means tomorrow.</td>
</tr>
<tr>
<td>regexp pattern</td>
<td>A regular expression pattern used to match a sting.</td>
<td><code>"$^"</code> matches an empty string. <code>"gtfs"</code> matches <code>"A-*gtfs*-file.zip"</code>. <code>"$\w{3})-.*\.xml^"</code> matches a filename with 3 alpha-numeric characters in the beginning of the filename and <em>.xml</em> as file extension.</td>
</tr>
<tr>
<td>uri</td>
<td>An URI path to a resource like a file or a URL.</td>
<td><code>"gs://bucket/path/a.obj"</code> <code>"http://foo.bar/"</code> `"file:///Users/x/local/file"</td>
</tr>
<tr>
<td>linear function</td>
<td>A linear function with one input parameter(x) used to calculate a value. Usually used to calculate a limit. For example to calculate a limit in seconds to be 1 hour plus 2 times the value(x) use: <code>3600 + 2.0 x</code>, to set an absolute value(3000) use: <code>3000 + 0x</code></td>
<td><code>"600 + 2.0 x"</code></td>
</tr>
</tbody>
</table>
<h1 id="system-wide-configuration">System-wide Configuration</h1>
<p>Using the file <code>otp-config.json</code> you can enable or disable different APIs and experimental
<a href="../SandboxExtension/">Sandbox Extensions</a>. By default, all supported APIs are enabled and all 
sandbox features are disabled. So for most OTP2 use cases it is not necessary to create this file.
Features that can be toggled in this file are generally only affect the routing phase of OTP2
usage, but for consistency all such "feature flags", even those that would affect graph building,
are managed in this one file. See the <a href="https://github.com/opentripplanner/OpenTripPlanner/blob/v2.0.0/src/main/java/org/opentripplanner/util/OTPFeature.java">OTPFeature</a> 
Java class for an enumeration of all available features and their default settings. Here is an 
example:</p>
<pre><code class="language-JSON">// otp-config.json
{
    &quot;otpFeatures&quot; : {
        &quot;APIBikeRental&quot; : false,
        &quot;SandboxExampleAPIGraphStatistics&quot; : true
    }
}
</code></pre>
<h1 id="graph-build-configuration">Graph Build Configuration</h1>
<p>This table lists all the JSON properties that can be defined in a <code>build-config.json</code> file. These will be stored in the graph itself, and affect any server that subsequently loads that graph. Sections follow that describe particular settings in more depth.</p>
<table>
<thead>
<tr>
<th>config key</th>
<th>description</th>
<th>value type</th>
<th>value default</th>
<th>notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>areaVisibility</code></td>
<td>Perform visibility calculations. If this is <code>true</code> OTP attempts to calculate a path straight through an OSM area using the shortest way rather than around the edge of it. (These calculations can be time consuming).</td>
<td>boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td><code>banDiscouragedWalking</code></td>
<td>should walking should be allowed on OSM ways tagged with <code>foot=discouraged"</code></td>
<td>boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td><code>banDiscouragedBiking</code></td>
<td>should walking should be allowed on OSM ways tagged with <code>bicycle=discouraged"</code></td>
<td>boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td><code>dataImportReport</code></td>
<td>Generate nice HTML report of Graph errors/warnings</td>
<td>boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td><code>distanceBetweenElevationSamples</code></td>
<td>TODO OTP2</td>
<td>double</td>
<td>10</td>
<td></td>
</tr>
<tr>
<td><code>elevationBucket</code></td>
<td>If specified, download NED elevation tiles from the given AWS S3 bucket</td>
<td>object</td>
<td>null</td>
<td>provide an object with <code>accessKey</code>, <code>secretKey</code>, and <code>bucketName</code> for AWS S3</td>
</tr>
<tr>
<td><code>elevationUnitMultiplier</code></td>
<td>Specify a multiplier to convert elevation units from source to meters</td>
<td>double</td>
<td>1.0</td>
<td>see <a href="#elevation-unit-conversion">Elevation unit conversion</a></td>
</tr>
<tr>
<td><code>embedRouterConfig</code></td>
<td>Embed the Router config in the graph, which allows it to be sent to a server fully configured over the wire</td>
<td>boolean</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td><code>extraEdgesStopPlatformLink</code></td>
<td>add extra edges when linking a stop to a platform, to prevent detours along the platform edge</td>
<td>boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td><code>fares</code></td>
<td>A specific fares service to use</td>
<td>object</td>
<td>null</td>
<td>see <a href="#fares-configuration">fares configuration</a></td>
</tr>
<tr>
<td><code>islandWithStopsMaxSize</code></td>
<td>Pruning threshold for islands with stops. Any such island under this size will be pruned</td>
<td>int</td>
<td>5</td>
<td></td>
</tr>
<tr>
<td><code>islandWithoutStopsMaxSize</code></td>
<td>Pruning threshold for islands without stops. Any such island under this size will be pruned</td>
<td>int</td>
<td>40</td>
<td></td>
</tr>
<tr>
<td><code>matchBusRoutesToStreets</code></td>
<td>Based on GTFS shape data, guess which OSM streets each bus runs on to improve stop linking</td>
<td>boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td><code>maxDataImportIssuesPerFile</code></td>
<td>If number of data import issues is larger then specified maximum number of issues the report will be split in multiple files</td>
<td>int</td>
<td>1,000</td>
<td></td>
</tr>
<tr>
<td><code>maxInterlineDistance</code></td>
<td>Maximal distance between stops in meters that will connect consecutive trips that are made with same vehicle</td>
<td>int</td>
<td>200</td>
<td>units: meters</td>
</tr>
<tr>
<td><code>maxTransferDistance</code></td>
<td>Transfers up to this length in meters will be pre-calculated and included in the Graph</td>
<td>double</td>
<td>2,000</td>
<td>units: meters</td>
</tr>
<tr>
<td><code>multiThreadElevationCalculations</code></td>
<td>If true, the elevation module will use multi-threading during elevation calculations.</td>
<td>boolean</td>
<td>false</td>
<td>see <a href="#elevation-data-calculation-optimizations">Elevation Data Calculation Optimizations</a></td>
</tr>
<tr>
<td><code>osmNaming</code></td>
<td>A custom OSM namer to use</td>
<td>object</td>
<td>null</td>
<td>see <a href="#custom-naming">custom naming</a></td>
</tr>
<tr>
<td><code>osmWayPropertySet</code></td>
<td>Custom OSM way properties</td>
<td>string</td>
<td><code>default</code></td>
<td>options: <code>default</code>, <code>finland</code>, <code>norway</code>, <code>uk</code></td>
</tr>
<tr>
<td><code>platformEntriesLinking</code></td>
<td>Link unconnected entries to public transport platforms</td>
<td>boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td><code>readCachedElevations</code></td>
<td>If true, reads in pre-calculated elevation data.</td>
<td>boolean</td>
<td>true</td>
<td>see <a href="#elevation-data-calculation-optimizations">Elevation Data Calculation Optimizations</a></td>
</tr>
<tr>
<td><code>staticBikeParkAndRide</code></td>
<td>Whether we should create bike P+R stations from OSM data</td>
<td>boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td><code>staticBikeRental</code></td>
<td>Whether bike rental stations should be loaded from OSM, rather than periodically dynamically pulled from APIs</td>
<td>boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td><code>staticParkAndRide</code></td>
<td>Whether we should create car P+R stations from OSM data</td>
<td>boolean</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td><code>streets</code></td>
<td>Include street input files (OSM/PBF)</td>
<td>boolean</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td><code>storage</code></td>
<td>Configure access to data sources like GRAPH/OSM/DEM/GTFS/NETEX/ISSUE-REPORT.</td>
<td>object</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td><code>subwayAccessTime</code></td>
<td>Minutes necessary to reach stops served by trips on routes of <code>route_type=1</code> (subway) from the street</td>
<td>double</td>
<td>2.0</td>
<td>units: minutes</td>
</tr>
<tr>
<td><code>transit</code></td>
<td>Include all transit input files (GTFS) from scanned directory</td>
<td>boolean</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td><code>transitServiceStart</code></td>
<td>Limit the import of transit services to the given <em>start</em> date. <em>Inclusive</em>. Use an absolute date or a period relative to the day the graph is build. To specify a week before the build date use a negative period like <code>-P1W</code>.</td>
<td>date or period</td>
<td>&minus;P1Y</td>
<td><em>2020&#8209;01&#8209;01, &minus;P1M3D, &minus;P3W</em></td>
</tr>
<tr>
<td><code>transitServiceEnd</code></td>
<td>Limit the import of transit services to the given <em>end</em> date. <em>Inclusive</em>. Use an absolute date or a period relative to the day the graph is build.</td>
<td>date or period</td>
<td>P3Y</td>
<td><em>2022&#8209;12&#8209;31, P1Y6M10D, P12W</em></td>
</tr>
<tr>
<td><code>useTransfersTxt</code></td>
<td>Create direct transfer edges from transfers.txt in GTFS, instead of based on distance</td>
<td>boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td><code>writeCachedElevations</code></td>
<td>If true, writes the calculated elevation data.</td>
<td>boolean</td>
<td>false</td>
<td>see <a href="#elevation-data-calculation-optimizations">Elevation Data Calculation Optimizations</a></td>
</tr>
</tbody>
</table>
<p>This list of parameters in defined in the <a href="https://github.com/opentripplanner/OpenTripPlanner/blob/v2.0.0/src/main/java/org/opentripplanner/standalone/config/BuildConfig.java">BuildConfig.java</a>.</p>
<h2 id="storage">Storage</h2>
<p>The storage section of <code>build-config.json</code> allows you to override the default behavior of scanning for input files in the <a href="./#Base Directory">base directory</a> and writing output files (such as the graph and error reports) to that same directory. In OTP2 it is now possible to read and write data located outside the local filesystem (including cloud storage services) or at various different locations around the local filesystem.</p>
<p>If your OTP instance is running on a cloud compute service, you may get significantly faster start-up and graph build times if you use the cloud storage directly instead of copying the files back and forth to cloud server instances. This also simplifies the deployment process. </p>
<h3 id="specifying-data-sources">Specifying Data Sources</h3>
<p>Here is a summary of the configuration keys that can be nested inside the<code>storage</code> property of the build-config JSON to specify input and output data sources:</p>
<table>
<thead>
<tr>
<th>config key</th>
<th>description</th>
<th>value type</th>
<th>value default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gsCredentials</code></td>
<td>Use an environment variable to point to the Google Cloud credentials: <code>"${MY_GOC_SERVICE}"</code>.</td>
<td>string</td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>graph</code></td>
<td>Absolute path where the graph file will be written, overriding the default of <code>graph.obj</code> in the base directory. Note that currently this option will also affect where the server <em>reads</em> the graph from.</td>
<td>uri</td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>streetGraph</code></td>
<td>Absolute path to the input street-graph file.</td>
<td>uri</td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>osm</code></td>
<td>List of absolute paths of OpenStreetMap input files to read.</td>
<td>uri []</td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>dem</code></td>
<td>List of absolute paths of Elevation DEM input files to read.</td>
<td>uri []</td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>gtfs</code></td>
<td>List of GTFS transit data files to read.</td>
<td>uri []</td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>netex</code></td>
<td>List of NeTEx transit data files to read.</td>
<td>uri []</td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>buildReportDir</code></td>
<td>Path to directory where the build issue report will be written.</td>
<td>uri</td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>localFileNamePatterns</code></td>
<td>Patterns used in determining the type of input files from their names.</td>
<td>object</td>
<td><code>null</code></td>
</tr>
</tbody>
</table>
<p>For example, this configuration could be used to load GTFS and OSM inputs from Google Cloud Storage:</p>
<pre><code class="language-JSON">// build-config.json
{
  &quot;storage&quot;: {
      &quot;osm&quot;: [&quot;gs://bucket-name/streets.pbf&quot;],
      &quot;gtfs&quot;: [&quot;gs://bucket-name/transit1.zip&quot;, &quot;gs://bucket-name/transit2.zip&quot;]
  }
}
</code></pre>
<p>The Google Storage system will inherit the permissions of the server it's running on within Google Cloud. It is also possible to supply credentials in this configuration file (see example below).</p>
<p>Note that when files are specified with URIs in this configuration, the file types do not need to be inferred from the file names so these GTFS files can have any names - there is no requirement that they have the letters "gtfs" in them.</p>
<p>The default behavior of scanning the base directory for inputs is overridden independently for each file type. So in the above configuration, GTFS and OSM will be loaded from Google Cloud Storage, but OTP2 will still scan the base directory for all other types such as DEM files. Supplying an empty array for a particular file type will ensure that no inputs of that type are loaded, including by local directory scanning.</p>
<p>See the comments in the source code of class <a href="https://github.com/opentripplanner/OpenTripPlanner/blob/v2.0.0/src/main/java/org/opentripplanner/standalone/config/StorageConfig.java">StorageConfig.java</a> 
for an up-to-date detailed description of each config parameter.</p>
<h3 id="local-filename-patterns">Local Filename Patterns</h3>
<p>When scanning the base directory for inputs, each file's name is checked against patterns to detect what kind of file it is. These patterns can be overridden in the config, by nesting a <code>localFileNamePatterns</code> property inside the <code>storage</code> property (see example below). Here are the keys you can place inside <code>localFileNamePatterns</code>:</p>
<table>
<thead>
<tr>
<th>config key</th>
<th>description</th>
<th>value type</th>
<th>value default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>osm</code></td>
<td>Pattern used to match Open Street Map files on local disk</td>
<td>regexp pattern</td>
<td><code>(?i)(\.pbf)</code></td>
</tr>
<tr>
<td><code>dem</code></td>
<td>Pattern used to match Elevation DEM files on local disk</td>
<td>regexp pattern</td>
<td><code>(?i)\.tiff?$</code></td>
</tr>
<tr>
<td><code>gtfs</code></td>
<td>Pattern used to match GTFS files on local disk</td>
<td>regexp pattern</td>
<td><code>(?i)gtfs</code></td>
</tr>
<tr>
<td><code>netex</code></td>
<td>Pattern used to match NeTEx files on local disk</td>
<td>regexp pattern</td>
<td><code>(?i)netex</code></td>
</tr>
</tbody>
</table>
<p>OTP1 used to peek inside ZIP files and read the CSV tables to guess if a ZIP was indeed GTFS. Now that we support remote input files (cloud storage or arbitrary URLs) not all data sources allow seeking within files to guess what they are. Therefore, like all other file types GTFS is now detected from a filename pattern. It is not sufficient to look for the <code>.zip</code> extension because Netex data is also often supplied in a ZIP file. </p>
<h3 id="storage-example">Storage example</h3>
<pre><code class="language-JSON">// build-config.json 
{
  &quot;storage&quot;: {
    // Use the GCS_SERVICE_CREDENTIALS environment variable to locate GCS credentials
    &quot;gsCredentials&quot;: &quot;${GCS_SERVICE_CREDENTIALS}&quot;,
    &quot;streetGraph&quot;: &quot;file:///Users/kelvin/otp/streetGraph.obj&quot;,
    &quot;osm&quot;: [&quot;gs://bucket-name/shared-osm-file.pbf&quot;],
    &quot;localFileNamePatterns&quot;: {
      // All filenames that start with &quot;g-&quot; and end with &quot;.zip&quot; is imported as a GTFS file.
      &quot;gtfs&quot; : &quot;^g-.*\\.zip$&quot;
    }
  }
}
</code></pre>
<h2 id="limit-the-transit-service-period">Limit the transit service period</h2>
<p>The properties <code>transitServiceStart</code> and <code>transitServiceEnd</code> can be used to limit the service dates. This affects both GTFS service calendars and dates. The service calendar is reduced and dates outside the period are dropped. OTP2 will compute a transit schedule for every day for which it can find at least one trip running. On the other hand, OTP will waste resources if a service end date is <em>unbounded</em> or very large (<code>9999-12-31</code>). To avoid this, limit the OTP service period. Also, if you provide a service with multiple feeds they may have different service end dates. To avoid inconsistent results, the period can be limited, so all feeds have data for the entire period. The default is to use a period of 1 year before, and 3 years after the day the graph is built. Limiting the period will <em>not</em> improve the search performance, but OTP will build faster and load faster in most cases.</p>
<p>The <code>transitServiceStart</code> and <code>transitServiceEnd</code> parameters are set using an absolute date like <code>2020-12-31</code> or a period like <code>P1Y6M5D</code> relative to the graph build date. Negative periods is used to specify dates in the past. The period is computed using the system time-zone, not the feed time-zone. Also, remember that the service day might be more than 24 hours. So be sure to include enough slack to account for the this. Setting the limits too wide have very little impact and is in general better than trying to be exact. The period and date format follow the ISO 8601 standard.</p>
<h2 id="reaching-a-subway-platform">Reaching a subway platform</h2>
<p>The ride locations for some modes of transport such as subways and airplanes can be slow to reach from the street.
When planning a trip, we need to allow additional time to reach these locations to properly inform the passenger. For
example, this helps avoid suggesting short bus rides between two subway rides as a way to improve travel time. You can
specify how long it takes to reach a subway platform</p>
<pre><code class="language-JSON">// build-config.json
{
  &quot;subwayAccessTime&quot;: 2.5
}
</code></pre>
<p>Stops in GTFS do not necessarily serve a single transit mode, but in practice this is usually the case. This additional
access time will be added to any stop that is visited by trips on subway routes (GTFS route_type = 1).</p>
<p>This setting does not generalize well to airplanes because you often need much longer to check in to a flight (2-3 hours
for international flights) than to alight and exit the airport (perhaps 1 hour). Therefore there is currently no
per-mode access time, it is subway-specific.</p>
<h2 id="transferring-within-stations">Transferring within stations</h2>
<p>Subway systems tend to exist in their own layer of the city separate from the surface, though there are exceptions where
tracks lie right below the street and transfers happen via the surface. In systems where the subway is quite deep
and transfers happen via tunnels, the time required for an in-station transfer is often less than that for a
surface transfer. A proposal was made to provide detailed station pathways in GTFS but it is not in common use.</p>
<p>One way to resolve this problem is by ensuring that the GTFS feed codes each platform as a separate stop, then
micro-mapping stations in OSM. When OSM data contains a detailed description of walkways, stairs, and platforms within
a station, GTFS stops can be linked to the nearest platform and transfers will happen via the OSM ways, which should
yield very realistic transfer time expectations. This works particularly well in above-ground train stations where
the layering of non-intersecting ways is less prevalent. Here's an example in the Netherlands:</p>
<iframe width="425" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://www.openstreetmap.org/export/embed.html?bbox=4.70502644777298%2C52.01675028000761%2C4.7070810198783875%2C52.01813190694357&amp;layer=mapnik" style="border: 1px solid black"></iframe>
<p><small><a href="http://www.openstreetmap.org/#map=19/52.01744/4.70605">View Larger Map</a></small>
When such micro-mapping data is not available, we need to rely on information from GTFS including how stops are grouped
into stations and a table of transfer timings where available. During the graph build, OTP can create preferential
connections between each pair of stops in the same station to favor in-station transfers:</p>
<pre><code class="language-JSON">// build-config.json
{
  &quot;stationTransfers&quot;: true
}
</code></pre>
<p>Note that this method is at odds with micro-mapping and might make some transfers artificially short.</p>
<h2 id="elevation-data">Elevation data</h2>
<p>OpenTripPlanner can "drape" the OSM street network over a digital elevation model (DEM).
This allows OTP to draw an elevation profile for the on-street portion of itineraries, and helps provide better
routing for bicyclists. It even helps avoid hills for walking itineraries. DEMs are usually supplied as rasters
(regular grids of numbers) stored in image formats such as GeoTIFF.</p>
<h3 id="us-national-elevation-dataset">U.S. National Elevation Dataset</h3>
<p>In the United States, a high resolution <a href="http://ned.usgs.gov/">National Elevation Dataset</a> is 
available for the entire territory. It used to be possible for OTP to download NED tiles on the fly 
from a rather complex USGS SOAP service. This process was somewhat unreliable and would greatly slow
 down the graph building process. In any case the service has since been replaced. But the USGS 
 would also deliver the whole dataset in bulk if you <a href="https://web.archive.org/web/20150811051917/http://ned.usgs.gov:80/faq.html#DATA">sent them a hard drive</a>. We did this many years back and uploaded 
 the entire data set to Amazon AWS S3. OpenTripPlanner contains another module that can automatically 
 fetch data in this format from any Amazon S3 copy of the bulk data. You can configure it as follows
  in <code>build-config.json</code>:</p>
<pre><code class="language-JSON">// router-config.json
{
    &quot;elevationBucket&quot;: {
        &quot;accessKey&quot;: &quot;your-aws-access-key&quot;,
        &quot;secretKey&quot;: &quot;corresponding-aws-secret-key&quot;,
        &quot;bucketName&quot;: &quot;ned13&quot;
    }
}
</code></pre>
<p>This <code>ned13</code> bucket is still available on S3 under a "requester pays" policy. As long as you specify 
valid AWS account credentials you should be able to download tiles, and any bandwidth costs will be 
billed to your AWS account.</p>
<p>Once the tiles are downloaded for a particular geographic area, OTP will keep them in local cache 
for the next graph build operation. You should add the <code>--cache &lt;directory&gt;</code> command line parameter 
to specify your NED tile cache location.</p>
<h3 id="geoid-difference">Geoid Difference</h3>
<p>Some elevation data sets are relative to mean sea level. At a global scale sea level is represented 
as a surface called the geoid, which is irregular in shape due to local gravitational anomalies. 
 On the other hand, GPS elevations are reported relative to the  WGS84 spheroid, a perfectly smooth 
 mathematical surface approximating the geoid. 
In cases where the two elevation definitions are mixed, it may be necessary to adjust elevation 
values to avoid confusing users with things like negative elevation values in places clearly above 
sea level. See <a href="https://github.com/opentripplanner/OpenTripPlanner/issues/2301">issue #2301</a> 
for detailed discussion of this. </p>
<p>OTP allows you to adjust the elevation values reported in API responses in two ways.
The first way is to store ellipsoid (GPS) elevation values internally, but apply a single geoid 
difference value in the OTP client where appropriate to display elevations above sea level.
This ellipsoid to geoid difference is returned in each trip plan response in the 
<a href="https://github.com/opentripplanner/OpenTripPlanner/blob/v2.0.0/src/main/java/org/opentripplanner/api/resource/ElevationMetadata.java">ElevationMetadata</a> field. 
Using a single value can be sufficient for smaller OTP deployments, but might result in incorrect 
values at the edges of larger OTP deployments. If your OTP instance uses this, it is recommended 
to set a default request value in the <code>router-config.json</code> file as follows:</p>
<pre><code class="language-JSON">// router-config.json
{
    &quot;routingDefaults&quot;: {
        &quot;geoidElevation&quot;: true   
    }
}
</code></pre>
<p>The second way is to precompute these geoid difference values at a more granular level and store 
all elevations internally relative to the geoid (sea level). Elevations returned in the API 
responses will then not need to be adjusted to match end users' intuitive understanding of elevation.
In order to speed up calculations, these geoid difference values are calculated and cached using only 
2 significant digits of GPS coordinates. This is more than enough detail for most regions of the 
world and should result in less than one meter of vertical error even in areas that have the largest
 geoid irregularities. To enable this, include the following in the <code>build-config.json</code> file: </p>
<pre><code class="language-JSON">// build-config.json
{
  &quot;includeEllipsoidToGeoidDifference&quot;: true
}
</code></pre>
<p>If the geoid difference values are precomputed, be careful to not set the routing resource value of <code>geoidElevation</code> to true in order to avoid having the graph-wide geoid added again to all elevation values in the relevant street edges in responses.</p>
<h3 id="other-raster-elevation-data">Other raster elevation data</h3>
<p>For other parts of the world you will need a GeoTIFF file containing the elevation data. These are often available from
national geographic surveys, or you can always fall back on the worldwide
<a href="http://www2.jpl.nasa.gov/srtm/">Space Shuttle Radar Topography Mission</a> (SRTM) data. This not particularly high resolution
(roughly 30 meters horizontally) but it can give acceptable results.</p>
<p>Simply place the elevation data file in the directory with the other graph builder inputs, alongside the GTFS and OSM data.
Make sure the file has a <code>.tiff</code> or <code>.tif</code> extension, and the graph builder should detect its presence and apply
the elevation data to the streets.</p>
<p>OTP should automatically handle DEM GeoTIFFs in most common projections. You may want to check for elevation-related
error messages during the graph build process to make sure OTP has properly discovered the projection. If you are using
a DEM in unprojected coordinates make sure that the axis order is (longitude, latitude) rather than
(latitude, longitude). Unfortunately there is no reliable standard for WGS84 axis order, so OTP uses the same axis
order as the above-mentioned SRTM data, which is also the default for the popular Proj4 library.</p>
<p>DEM files(USGS DEM) is not supported by OTP, but can be converted to GeoTIFF with tools like <a href="http://www.gdal.org/">GDAL</a>. 
Use <code>gdal_merge.py -o merged.tiff *.dem</code> to merge a set of <code>dem</code> files into one <code>tif</code> file.</p>
<p>See Interline <a href="https://github.com/interline-io/planetutils">PlanetUtils</a> for a set of scripts to download, merge, and resample <a href="https://registry.opendata.aws/terrain-tiles/">Mapzen/Amazon Terrain Tiles</a>.</p>
<h3 id="elevation-unit-conversion">Elevation unit conversion</h3>
<p>By default, OTP expects the elevation data to use metres. However, by setting <code>elevationUnitMultiplier</code> in <code>build-config.json</code>,
it is possible to define a multiplier that converts the elevation values from some other unit to metres.</p>
<pre><code class="language-JSON">// build-config.json
{
  // Correct conversation multiplier when source data uses decimetres instead of metres
  &quot;elevationUnitMultiplier&quot;: 0.1
}
</code></pre>
<h3 id="elevation-data-calculation-optimizations">Elevation Data Calculation Optimizations</h3>
<p>Calculating elevations on all StreetEdges can take a dramatically long time. In a very large graph build for multiple Northeast US states, the time it took to download the elevation data and calculate all of the elevations took 5,509 seconds (roughly 1.5 hours).</p>
<p>If you are using cloud computing for your OTP instances, it is recommended to create prebuilt images that contain the elevation data you need. This will save time because all of the data won't need to be downloaded.</p>
<p>However, the bulk of the time will still be spent calculating elevations for all of the street edges. Therefore, a further optimization can be done to calculate and save the elevation data during a graph build and then save it for future use.</p>
<h4 id="reusing-elevation-data-from-previous-builds">Reusing elevation data from previous builds</h4>
<p>In order to write out the precalculated elevation data, add this to your <code>build-config.json</code> file:</p>
<pre><code class="language-JSON">// build-config.json
{  
  &quot;writeCachedElevations&quot;: true
}
</code></pre>
<p>After building the graph, a file called <code>cached_elevations.obj</code> will be written to the cache directory. By default, this file is not written during graph builds. There is also a graph build parameter called <code>readCachedElevations</code> which is set to <code>true</code> by default.</p>
<p>In graph builds, the elevation module will attempt to read the <code>cached_elevations.obj</code> file from the cache directory. The cache directory defaults to <code>/var/otp/cache</code>, but this can be overriden via the CLI argument <code>--cache &lt;directory&gt;</code>. For the same graph build for multiple Northeast US states, the time it took with using this predownloaded and precalculated data became 543.7 seconds (roughly 9 minutes).</p>
<p>The cached data is a lookup table where the coordinate sequences of respective street edges are used as keys for calculated data. It is assumed that all of the other input data except for the OpenStreetMap data remains the same between graph builds. Therefore, if the underlying elevation data is changed, or different configuration values for <code>elevationUnitMultiplier</code> or <code>includeEllipsoidToGeoidDifference</code> are used, then this data becomes invalid and all elevation data should be recalculated. Over time, various edits to OpenStreetMap will cause this cached data to become stale and not include new OSM ways. Therefore, periodic update of this cached data is recommended.</p>
<h4 id="configuring-multi-threading-during-elevation-calculations">Configuring multi-threading during elevation calculations</h4>
<p>For unknown reasons that seem to depend on data and machine settings, it might be faster to use a single processor. For this reason, multi-threading of elevation calculations is only done if <code>multiThreadElevationCalculations</code> is set to true. To enable multi-threading in the elevation module, add the following to the <code>build-config.json</code> file:</p>
<pre><code class="language-JSON">// build-config.json
{  
  &quot;multiThreadElevationCalculations&quot;: true
}
</code></pre>
<h2 id="fares-configuration">Fares configuration</h2>
<p>By default OTP will compute fares according to the GTFS specification if fare data is provided in
your GTFS input. It is possible to turn off this by setting the fare to "off". For more complex 
scenarios or to handle bike rental fares, it is necessary to manually configure fares using the
<code>fares</code> section in <code>build-config.json</code>. You can combine different fares (for example transit and
bike-rental) by defining a <code>combinationStrategy</code> parameter, and a list of sub-fares to combine 
(all fields starting with <code>fare</code> are considered to be sub-fares).</p>
<pre><code class="language-JSON">// build-config.json
{
  // Select the custom fare &quot;seattle&quot;
  &quot;fares&quot;: &quot;seattle&quot;,
  // OR this alternative form that could allow additional configuration
  &quot;fares&quot;: {
    &quot;type&quot;: &quot;seattle&quot;
  }
}
</code></pre>
<pre><code class="language-JSON">// build-config.json
{
  &quot;fares&quot;: {
    // Combine two fares by simply adding them
    &quot;combinationStrategy&quot;: &quot;additive&quot;,
    // First fare to combine
    &quot;fare0&quot;: &quot;new-york&quot;,
    // Second fare to combine
    &quot;fare1&quot;: {
      &quot;type&quot;: &quot;bike-rental-time-based&quot;,
      &quot;currency&quot;: &quot;USD&quot;,
      &quot;prices&quot;: {
          // For trip shorter than 30', $4 fare
          &quot;30&quot;:   4.00,
          // For trip shorter than 1h, $6 fare
          &quot;1:00&quot;: 6.00
      }
    }
    // We could also add fareFoo, fareBar...
  }
}
</code></pre>
<p>Turning the fare service <em>off</em>, this will ignore any fare data in the provided GTFS data.</p>
<pre><code class="language-JSON">// build-config.json
{
  &quot;fares&quot;: &quot;off&quot;
}
</code></pre>
<p>The current list of custom fare type is:</p>
<ul>
<li><code>bike-rental-time-based</code> - accepting the following parameters:<ul>
<li><code>currency</code> - the ISO 4217 currency code to use, such as <code>"EUR"</code> or <code>"USD"</code>,</li>
<li><code>prices</code> - a list of {time, price}. The resulting cost is the smallest cost where the elapsed time of bike rental is lower than the defined time.</li>
</ul>
</li>
<li><code>san-francisco</code> (no parameters)</li>
<li><code>new-york</code> (no parameters)</li>
<li><code>seattle</code> (no parameters)</li>
<li><code>off</code> (no parameters)</li>
</ul>
<p>The current list of <code>combinationStrategy</code> is:</p>
<ul>
<li><code>additive</code> - simply adds all sub-fares.</li>
</ul>
<h2 id="osm-openstreetmap-configuration">OSM / OpenStreetMap configuration</h2>
<p>It is possible to adjust how OSM data is interpreted by OpenTripPlanner when building the road part of the routing graph.</p>
<h3 id="way-property-sets">Way property sets</h3>
<p>OSM tags have different meanings in different countries, and how the roads in a particular country or region are tagged affects routing. As an example are roads tagged with `highway=trunk (mainly) walkable in Norway, but forbidden in some other countries. This might lead to OTP being unable to snap stops to these roads, or by giving you poor routing results for walking and biking.
You can adjust which road types that are accessible by foot, car &amp; bicycle as well as speed limits, suitability for biking and walking.</p>
<p>There are currently 3 wayPropertySets defined;</p>
<ul>
<li><code>default</code> which is based on California/US mapping standard</li>
<li><code>norway</code> which is adjusted to rules and speeds in Norway</li>
<li><code>uk</code> which is adjusted to rules and speed in the UK</li>
</ul>
<p>To add your own custom property set have a look at <code>org.opentripplanner.graph_builder.module.osm.NorwayWayPropertySet</code> and <code>org.opentripplanner.graph_builder.module.osm.DefaultWayPropertySet</code>. If you choose to mainly rely on the default rules, make sure you add your own rules first before applying the default ones. The mechanism is that for any two identical tags, OTP will use the first one.</p>
<pre><code class="language-JSON">// build-config.json
{
  &quot;osmWayPropertySet&quot;: &quot;norway&quot;
}
</code></pre>
<h3 id="custom-naming">Custom naming</h3>
<p>You can define a custom naming scheme for elements drawn from OSM by defining an <code>osmNaming</code> field in <code>build-config.json</code>,
such as:</p>
<pre><code class="language-JSON">// build-config.json
{
  &quot;osmNaming&quot;: &quot;portland&quot;
}
</code></pre>
<p>There is currently only one custom naming module called <code>portland</code> (which has no parameters).</p>
<h1 id="router-configuration">Router configuration</h1>
<p>This section covers all options that can be set for each router using the <code>router-config.json</code> file.
These options can be applied by the OTP server without rebuilding the graph.</p>
<table>
<thead>
<tr>
<th>config key</th>
<th>description</th>
<th>value type</th>
<th>value default</th>
<th>notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>routingDefaults</code></td>
<td>Default routing parameters, which will be applied to every request</td>
<td>object</td>
<td></td>
<td>see <a href="#routing-defaults">routing defaults</a></td>
</tr>
<tr>
<td><code>streetRoutingTimeout</code></td>
<td>maximum time limit for street route queries</td>
<td>double</td>
<td>null</td>
<td>units: seconds; see <a href="#timeout">timeout</a></td>
</tr>
<tr>
<td><code>requestLogFile</code></td>
<td>Path to a plain-text file where requests will be logged</td>
<td>string</td>
<td>null</td>
<td>see <a href="#logging-incoming-requests">logging incoming requests</a></td>
</tr>
<tr>
<td><code>transit</code></td>
<td>Transit tuning parameters</td>
<td><code>TransitRoutingConfig</code></td>
<td></td>
<td>see <a href="#Tuning-transit-routing">Tuning transit routing</a></td>
</tr>
<tr>
<td><code>updaters</code></td>
<td>configure real-time updaters, such as GTFS-realtime feeds</td>
<td>object</td>
<td>null</td>
<td>see <a href="#configuring-real-time-updaters">configuring real-time updaters</a></td>
</tr>
<tr>
<td><code>transmodelApi</code></td>
<td>configure Entur Transmodel API (<strong>Sandbox</strong>)</td>
<td>object</td>
<td>null</td>
<td>See the code for parameters, no doc provided.</td>
</tr>
</tbody>
</table>
<h2 id="routing-defaults">Routing defaults</h2>
<p>There are many trip planning options used in the OTP web API, and more exist
internally that are not exposed via the API. You may want to change the default value for some of these parameters,
i.e. the value which will be applied unless it is overridden in a web API request.</p>
<p>A full list of them can be found in the <a href="https://github.com/opentripplanner/OpenTripPlanner/blob/v2.0.0/src/main/java/org/opentripplanner/routing/api/request/RoutingRequest.java">RoutingRequest</a>.
Any public field or setter method in this class can be given a default value using the routingDefaults section of
<code>router-config.json</code> as follows:</p>
<pre><code class="language-JSON">// router-config.json
{
    &quot;routingDefaults&quot;: {
        &quot;walkSpeed&quot;: 2.0,
        &quot;stairsReluctance&quot;: 4.0,
        &quot;carDropoffTime&quot;: 240
    }
}
</code></pre>
<h2 id="tuning-itinerary-filtering">Tuning itinerary filtering</h2>
<p>Nested inside <code>routingDefaults {...}</code> in <code>router-config.json</code>.</p>
<p>OTP2 may produce numerous <em>pareto-optimal</em> results when using <code>time</code>, <code>number-of-transfers</code> and <code>generalized-cost</code> as criteria. Use the parameters listed here to reduce/filter the itineraries return by the search engine before returning the results to client.</p>
<table>
<thead>
<tr>
<th>config key</th>
<th>description</th>
<th>value type</th>
<th>value default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>debugItineraryFilter</code></td>
<td>Enable this to attach a system notice to itineraries instead of removing them. Some filters are not configurable, byt will show up in the system-notice if debugging is enabled.</td>
<td>boolean</td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>groupBySimilarityKeepOne</code></td>
<td>Pick ONE itinerary from each group after putting itineraries that is 85% similar together.</td>
<td>double</td>
<td><code>0.85</code> (85%)</td>
</tr>
<tr>
<td><code>groupBySimilarityKeepNumOfItineraries</code></td>
<td>Reduce the number of itineraries to the requested number by reducing each group of itineraries grouped by 68% similarity.</td>
<td>double</td>
<td><code>0.68</code> (68%)</td>
</tr>
<tr>
<td><code>transitGeneralizedCostLimit</code></td>
<td>A relative maximum limit for the generalized cost for transit itineraries. The limit is a linear function of the minimum generalized-cost. The function is used to calculate a max-limit. The max-limit is then used to to filter by generalized-cost. Transit itineraries with a cost higher than the max-limit is dropped from the result set. None transit itineraries is excluded from the filter. To set a filter to be 1 hour plus 2 times the best cost use: <code>3600 + 2.0 x</code>. To set an absolute value(3000) use: <code>3000 + 0x</code></td>
<td>linear function</td>
<td><code>null</code></td>
</tr>
</tbody>
</table>
<h3 id="group-by-filters">Group-by-filters</h3>
<p>The group-by-filter is a bit complex, but should be simple to use. Set <code>debugItineraryFilter=true</code> 
and experiment with <code>searchWindow</code> and the two group-by parameters(<code>debugItineraryFilter</code> and 
<code>groupBySimilarityKeepNumOfItineraries</code>). </p>
<p>The group-by-filter work by grouping itineraries together and then reducing the number of 
itineraries in each group, keeping the itinerary/itineraries with the best <em>generalized-cost</em>. The 
group-by function first pick all transit legs that account for more than N% of the itinerary based 
on distance traveled. This become the group-key. To keys are the same if all legs in one of the keys
also exist in the other. Note, one key may have a lager set of legs than the other, but they can 
still be the same. When comparing to legs we compare the <code>tripId</code> and make sure the legs overlap in
place and time. Two legs are the same if both legs ride at least a common subsection of the same 
trip. The <code>groupBySimilarityKeepOne</code> filter will keep ONE itinerary in each group. The 
<code>groupBySimilarityKeepNumOfItineraries</code> is a bit more complex, because it uses the 
<code>numOfItineraries</code> request parameter to estimate a maxLimit for each group. For example, if the 
<code>numOfItineraries</code> is 5 elements and there is 3 groups, we set the <em>max-limit</em> for each group
to 2, returning between 4 and 6 elements depending on the distribution. The <em>max-limit</em> can never 
be less than 1.</p>
<h3 id="drive-to-transit-routing-defaults">Drive-to-transit routing defaults</h3>
<p>When using the "park and ride" or "kiss and ride" modes (drive to transit), the initial driving time to reach a transit
stop or park and ride facility is constrained. You can set a drive time limit in seconds by adding a line like
<code>maxPreTransitTime = 1200</code> to the routingDefaults section. If the limit is too high on a very large street graph, routing
performance may suffer.</p>
<h2 id="boarding-and-alighting-times">Boarding and alighting times</h2>
<p>Sometimes there is a need to configure a longer ride or alighting times for specific modes, such as airplanes or ferries,
where the check-in process needs to be done in good time before ride. The ride time is added to the time when going
from the stop (offboard) vertex to the onboard vertex, and the alight time is added vice versa. The times are configured as
seconds needed for the ride and alighting processes in <code>router-config.json</code> as follows:</p>
<pre><code class="language-JSON">// router-config.json
{
  &quot;boardTimes&quot;: {
    &quot;AIRPLANE&quot;: 2700
  },
  &quot;alightTimes&quot;: {
    &quot;AIRPLANE&quot;: 1200
  }
}
</code></pre>
<h2 id="timeout">Timeout</h2>
<p>In OTP1 path searches sometimes toke a long time to complete. With the new Raptor algorithm this not
the case anymore. The street part of the routing may still take a long time if searching very long
distances. You can set the street routing timeout to avoid tying up server resources on pointless
searches and ensure that your users receive a timely response. You can also limit the max distance
to search for WALK, BIKE and CAR. When a search times out, a WARN level log entry is made with
information that can help identify problematic searches and improve our routing methods. There are 
no timeouts for the transit part of the routing search, instead configure a reasonable dynamic 
search-window. To set the street routing timeout use the following config:</p>
<pre><code class="language-JSON">// router-config.json
{
  &quot;streetRoutingTimeout&quot;: 5.5
}
</code></pre>
<p>This specifies a timeout in (optionally fractional) seconds. The search abort after this many seconds and any paths found are returned to the client. </p>
<h2 id="logging-incoming-requests">Logging incoming requests</h2>
<p>You can log some characteristics of trip planning requests in a file for later analysis. Some transit agencies and
operators find this information useful for identifying existing or unmet transportation demand. Logging will be
performed only if you specify a log file name in the router config:</p>
<pre><code class="language-JSON">// router-config.json
{
  &quot;requestLogFile&quot;: &quot;/var/otp/request.log&quot;
}
</code></pre>
<p>Each line in the resulting log file will look like this:</p>
<p><code>2016-04-19T18:23:13.486 0:0:0:0:0:0:0:1 ARRIVE 2016-04-07T00:17 WALK,BUS,CABLE_CAR,TRANSIT,BUSISH 45.559737193889966 -122.64999389648438 45.525592487765635 -122.39044189453124 6095 3 5864 3 6215 3</code></p>
<p>The fields separated by whitespace are (in order):</p>
<ol>
<li>Date and time the request was received</li>
<li>IP address of the user</li>
<li>Arrive or depart search</li>
<li>The arrival or departure time</li>
<li>A comma-separated list of all transport modes selected</li>
<li>Origin latitude and longitude</li>
<li>Destination latitude and longitude</li>
</ol>
<p>Finally, for each itinerary returned to the user, there is a travel duration in seconds and the number of transit vehicles used in that itinerary.</p>
<h2 id="tuning-transit-routing">Tuning transit routing</h2>
<p>Nested inside <code>transit {...}</code> in <code>router-config.json</code>.</p>
<p>Some of these parameters for tuning transit routing is only available through configuration and cannot be set in the routing request. These parameters work together with the default routing request and the actual routing request.</p>
<table>
<thead>
<tr>
<th>config key</th>
<th>description</th>
<th>value type</th>
<th>value default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>maxNumberOfTransfers</code></td>
<td>Use this parameter to allocate enough space for Raptor. Set it to the maximum number of transfers for any given itinerary expected to be found within the entire transit network. The memory overhead of setting this higher than the maximum number of transfers is very little so it is better to set it too high then to low.</td>
<td>int</td>
<td><code>12</code></td>
</tr>
<tr>
<td><code>scheduledTripBinarySearchThreshold</code></td>
<td>The threshold is used to determine when to perform a binary trip schedule search to reduce the number of trips departure time lookups and comparisons. When testing with data from Entur and all of Norway as a Graph, the optimal value was around 50. Changing this may improve the performance with just a few percent.</td>
<td>int</td>
<td><code>50</code></td>
</tr>
<tr>
<td><code>iterationDepartureStepInSeconds</code></td>
<td>Step for departure times between each RangeRaptor iterations. A transit network usually uses minute resolution for its depature and arrival times. To match that, set this variable to 60 seconds.</td>
<td>int</td>
<td><code>60</code></td>
</tr>
<tr>
<td><code>searchThreadPoolSize</code></td>
<td>Split a travel search in smaller jobs and run them in parallel to improve performance. Use this parameter to set the total number of executable threads available across all searches. Multiple searches can run in parallel - this parameter have no effect with regard to that. If 0, no extra threads are started and the search is done in one thread.</td>
<td>int</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>dynamicSearchWindow</code></td>
<td>The dynamic search window coefficients used to calculate the EDT(earliest-departure-time), LAT(latest-arrival-time) and SW(raptor-search-window) using heuristics.</td>
<td>object</td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>stopTransferCost</code></td>
<td>Use this to set a stop transfer cost for the given <a href="https://github.com/opentripplanner/OpenTripPlanner/blob/v2.0.0/src/main/java/org/opentripplanner/model/TransferPriority.java">TransferPriority</a>. The cost is applied to boarding and alighting at all stops. All stops have a transfer cost priority set, the default is <code>ALLOWED</code>. The <code>stopTransferCost</code> parameter is optional, but if listed all values must be set.</td>
<td>enum map</td>
<td><code>null</code></td>
</tr>
</tbody>
</table>
<h3 id="tuning-transit-routing-dynamic-search-window">Tuning transit routing - Dynamic search window</h3>
<p>Nested inside <code>transit : { dynamicSearchWindow : { ... } }</code> in <code>router-config.json</code>.</p>
<table>
<thead>
<tr>
<th>config key</th>
<th>description</th>
<th>value type</th>
<th>value default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>minTripTimeCoefficient</code></td>
<td>The coefficient to multiply with minimum travel time found using a heuristic search. This value is added to the <code>minWinTimeMinutes</code>. A value between <code>0.0</code> to <code>3.0</code> is expected to give ok results.</td>
<td>double</td>
<td><code>0.75</code></td>
</tr>
<tr>
<td><code>minWinTimeMinutes</code></td>
<td>The constant minimum number of minutes for a raptor search window. Use a value between 20-180 minutes in a normal deployment.</td>
<td>int</td>
<td><code>40</code></td>
</tr>
<tr>
<td><code>maxWinTimeMinutes</code></td>
<td>Set an upper limit to the calculation of the dynamic search window to prevent exceptionable cases to cause very long search windows. Long search windows consumes a lot of resources and may take a long time. Use this parameter to tune the desired maximum search time.</td>
<td>int</td>
<td><code>180</code> (3 hours)</td>
</tr>
<tr>
<td><code>stepMinutes</code></td>
<td>The search window is rounded of to the closest multiplication of N minutes. If N=10 minutes, the search-window can be 10, 20, 30 ... minutes. It the computed search-window is 5 minutes and 17 seconds it will be rounded up to 10 minutes.</td>
<td>int</td>
<td><code>10</code></td>
</tr>
</tbody>
</table>
<h3 id="tuning-transit-routing-stop-transfer-cost">Tuning transit routing - Stop transfer cost</h3>
<p>Nested inside <code>transit : { stopTransferCost : { ... } }</code> in <code>router-config.json</code>.</p>
<p>This <em>cost</em> is in addition to other costs like <code>boardCost</code> and indirect cost from waiting (board-/alight-/transfer slack). You should account for this when you tune the routing search parameters.</p>
<p>If not set the <code>stopTransferCost</code> is ignored. This is only available for NeTEx imported Stops. </p>
<p>The cost is a scalar, but is equivalent to the felt cost of riding a transit trip for 1 second.</p>
<table>
<thead>
<tr>
<th>config key</th>
<th>description</th>
<th>value type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DISCOURAGED</code></td>
<td>Use a very high cost like <code>72 000</code> to eliminate transfers ath the stop if not the only option.</td>
<td>int</td>
</tr>
<tr>
<td><code>ALLOWED</code></td>
<td>Allowed, but not recommended. Use something like <code>150</code>.</td>
<td>int</td>
</tr>
<tr>
<td><code>RECOMMENDED</code></td>
<td>Use a small cost penalty like <code>60</code>.</td>
<td>int</td>
</tr>
<tr>
<td><code>PREFERRED</code></td>
<td>The best place to do transfers. Should be set to <code>0</code>(zero).</td>
<td>int</td>
</tr>
</tbody>
</table>
<p>Use values in a range from <code>0</code> to <code>100 000</code>. <strong>All key/value pairs are required if the <code>stopTransferCost</code> is listed.</strong> </p>
<h3 id="transit-example">Transit example</h3>
<pre><code class="language-JSON">// router-config.json
{
    &quot;transit&quot;: {
        &quot;maxNumberOfTransfers&quot;: 12,
        &quot;scheduledTripBinarySearchThreshold&quot;: 50,
        &quot;iterationDepartureStepInSeconds&quot;: 60,
        &quot;searchThreadPoolSize&quot;: 0,
        &quot;dynamicSearchWindow&quot;: {
            &quot;minTripTimeCoefficient&quot;: 0.4,
            &quot;minTimeMinutes&quot;: 30,
            &quot;maxLengthMinutes&quot; : 360,
            &quot;stepMinutes&quot;: 10
        },
        &quot;stopTransferCost&quot;: {
            &quot;DISCOURAGED&quot;: 72000,
            &quot;ALLOWED&quot;:       150,
            &quot;RECOMMENDED&quot;:    60,
            &quot;PREFERRED&quot;:       0
        }
    }
}
</code></pre>
<h2 id="real-time-data">Real-time data</h2>
<p>GTFS feeds contain <em>schedule</em> data that is is published by an agency or operator in advance. The feed does not account
 for unexpected service changes or traffic disruptions that occur from day to day. Thus, this kind of data is also
 referred to as 'static' data or 'theoretical' arrival and departure times.</p>
<h3 id="gtfs-realtime">GTFS-Realtime</h3>
<p>The <a href="https://developers.google.com/transit/gtfs-realtime/">GTFS-RT spec</a> complements GTFS with three additional kinds of
feeds. In contrast to the base GTFS schedule feed, they provide <em>real-time</em> updates (<em>'dynamic'</em> data) and are are
updated from minute to minute.</p>
<ul>
<li>
<p><strong>Alerts</strong> are text messages attached to GTFS objects, informing riders of disruptions and changes.</p>
</li>
<li>
<p><strong>TripUpdates</strong> report on the status of scheduled trips as they happen, providing observed and predicted arrival and
departure times for the remainder of the trip.</p>
</li>
<li>
<p><strong>VehiclePositions</strong> give the location of some or all vehicles currently in service, in terms of geographic coordinates
or position relative to their scheduled stops.</p>
</li>
</ul>
<h3 id="bicycle-rental-systems">Bicycle rental systems</h3>
<p>Besides GTFS-RT transit data, OTP can also fetch real-time data about bicycle rental networks including the number
of bikes and free parking spaces at each station. We support bike rental systems from JCDecaux, BCycle, VCub, Keolis,
Bixi, the Dutch OVFiets system, ShareBike, GBFS and a generic KML format.
It is straightforward to extend OTP to support any bike rental system that
exposes a JSON API or provides KML place markers, though it requires writing a little code.</p>
<p>The generic KML needs to be in format like</p>
<pre><code class="language-XML">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;kml xmlns=&quot;http://www.opengis.net/kml/2.2&quot;&gt;
&lt;Document id=&quot;root_doc&quot;&gt;
&lt;Schema name=&quot;citybikes&quot; id=&quot;citybikes&quot;&gt;
    &lt;SimpleField name=&quot;ID&quot; type=&quot;int&quot;&gt;&lt;/SimpleField&gt;
&lt;/Schema&gt;
  &lt;Placemark&gt;
    &lt;name&gt;A Bike Station&lt;/name&gt;
    &lt;ExtendedData&gt;&lt;SchemaData schemaUrl=&quot;#citybikes&quot;&gt;
        &lt;SimpleData name=&quot;ID&quot;&gt;0&lt;/SimpleData&gt;
    &lt;/SchemaData&gt;&lt;/ExtendedData&gt;
      &lt;Point&gt;&lt;coordinates&gt;24.950682884886643,60.155923430488102&lt;/coordinates&gt;&lt;/Point&gt;
  &lt;/Placemark&gt;
&lt;/Document&gt;&lt;/kml&gt;
</code></pre>
<h3 id="configuring-real-time-updaters">Configuring real-time updaters</h3>
<p>Real-time data can be provided using either a pull or push system. In a pull configuration, the GTFS-RT consumer polls the
real-time provider over HTTP. That is to say, OTP fetches a file from a web server every few minutes. In the push
configuration, the consumer opens a persistent connection to the GTFS-RT provider, which then sends incremental updates
immediately as they become available. OTP can use both approaches. The <a href="https://github.com/OneBusAway/onebusaway-gtfs-realtime-exporter">OneBusAway GTFS-realtime exporter project</a> provides this kind of streaming, incremental updates over a websocket rather than a single large file.</p>
<p>Real-time data sources are configured in <code>router-config.json</code>. The <code>updaters</code> section is an array of JSON objects, each
of which has a <code>type</code> field and other configuration fields specific to that type. Common to all updater entries that
connect to a network resource is the <code>url</code> field.</p>
<pre><code class="language-JSON">// router-config.json
{
    // Routing defaults are any public field or setter in the Java class
    // org.opentripplanner.routing.api.request.RoutingRequest
    &quot;routingDefaults&quot;: {
        &quot;numItineraries&quot;: 6,
        &quot;walkSpeed&quot;: 2.0,
        &quot;stairsReluctance&quot;: 4.0,
        &quot;carDropoffTime&quot;: 240
    },

    &quot;updaters&quot;: [

        // GTFS-RT service alerts (frequent polling)
        {
            &quot;type&quot;: &quot;real-time-alerts&quot;,
            &quot;frequencySec&quot;: 30,
            &quot;url&quot;: &quot;http://developer.trimet.org/ws/V1/FeedSpecAlerts/appID/0123456789ABCDEF&quot;,
            &quot;feedId&quot;: &quot;TriMet&quot;
        },

        // Polling bike rental updater.
        // sourceType can be: jcdecaux, b-cycle, bixi, keolis-rennes, ov-fiets,
        // city-bikes, citi-bike-nyc, next-bike, vcub, kml
        {
            &quot;type&quot;: &quot;bike-rental&quot;,
            &quot;frequencySec&quot;: 300,
            &quot;sourceType&quot;: &quot;city-bikes&quot;,
            &quot;url&quot;: &quot;http://host.domain.tld&quot;
        },

        //&lt;!--- San Francisco Bay Area bike share --&gt;
        {
          &quot;type&quot;: &quot;bike-rental&quot;,
          &quot;frequencySec&quot;: 300,
          &quot;sourceType&quot;: &quot;sf-bay-area&quot;,
          &quot;url&quot;: &quot;http://www.bayareabikeshare.com/stations/json&quot;
        },

        //&lt;!--- Tampa Area bike share --&gt;
        {
          &quot;type&quot;: &quot;bike-rental&quot;,
          &quot;frequencySec&quot;: 300,
          &quot;sourceType&quot;: &quot;gbfs&quot;,
          &quot;url&quot;: &quot;http://coast.socialbicycles.com/opendata/&quot;
        },

        // Polling bike rental updater for DC bikeshare (a Bixi system)
        // Negative update frequency means to run once and then stop updating (essentially static data)
        {
            &quot;type&quot;: &quot;bike-rental&quot;,
            &quot;sourceType&quot;: &quot;bixi&quot;,
            &quot;url&quot;: &quot;https://www.capitalbikeshare.com/data/stations/bikeStations.xml&quot;,
            &quot;frequencySec&quot;: -1
        },

        // Bike parking availability
        {
            &quot;type&quot;: &quot;bike-park&quot;
        },

        // Polling for GTFS-RT TripUpdates)
        {
            &quot;type&quot;: &quot;stop-time-updater&quot;,
            &quot;frequencySec&quot;: 60,
            // this is either http or file... shouldn't it default to http or guess from the presence of a URL?
            &quot;sourceType&quot;: &quot;gtfs-http&quot;,
            &quot;url&quot;: &quot;http://developer.trimet.org/ws/V1/TripUpdate/appID/0123456789ABCDEF&quot;,
            &quot;feedId&quot;: &quot;TriMet&quot;
        },

        // Streaming differential GTFS-RT TripUpdates over websockets
        {
            &quot;type&quot;: &quot;websocket-gtfs-rt-updater&quot;
        }
    ]
}
</code></pre>
<h4 id="gbfs-configuration">GBFS Configuration</h4>
<p>Steps to add a GBFS feed to a router:</p>
<ul>
<li>Add one entry in the <code>updater</code> field of <code>router-config.json</code> in the format</li>
</ul>
<pre><code class="language-JSON">// router-config.json
{
     &quot;type&quot;: &quot;bike-rental&quot;,
     &quot;frequencySec&quot;: 60,
     &quot;sourceType&quot;: &quot;gbfs&quot;,
     &quot;url&quot;: &quot;http://coast.socialbicycles.com/opendata/&quot;
}
</code></pre>
<ul>
<li>Follow these instructions to fill these fields:</li>
</ul>
<pre><code>type: &quot;bike-rental&quot;
frequencySec: frequency in seconds in which the GBFS service will be polled
sourceType: &quot;gbfs&quot;
url: the URL of the GBFS feed (do not include the gbfs.json at the end) *
</code></pre>
<p>* For a list of known GBFS feeds see the <a href="https://github.com/NABSA/gbfs/blob/master/systems.csv">list of known GBFS feeds</a></p>
<h4 id="bike-rental-service-directory-configuration-sandbox-feature">Bike Rental Service Directory configuration (sandbox feature)</h4>
<p>To configure and url for the <a href="../sandbox/BikeRentalServiceDirectory/">BikeRentalServiceDirectory</a>.</p>
<pre><code class="language-JSON">// router-config.json
{
  &quot;bikeRentalServiceDirectoryUrl&quot;: &quot;https://api.dev.entur.io/mobility/v1/bikes&quot;
}
</code></pre>
<h1 id="configure-using-command-line-arguments">Configure using command-line arguments</h1>
<p>Certain settings can be provided on the command line, when starting OpenTripPlanner. See the <code>CommandLineParameters</code> class for <a href="https://github.com/opentripplanner/OpenTripPlanner/blob/v2.0.0/src/main/java/org/opentripplanner/standalone/config/CommandLineParameters.java">a full list of arguments</a>.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../js/version-select.js" defer></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
