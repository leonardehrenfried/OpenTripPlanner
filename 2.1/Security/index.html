<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://docs.opentripplanner.org/2.1/Security/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Security - OpenTripPlanner 2</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../css/version-select.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">OpenTripPlanner 2</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Governance/" class="dropdown-item">Governance</a>
</li>
                                    
<li>
    <a href="../History/" class="dropdown-item">History</a>
</li>
                                    
<li>
    <a href="../Deployments/" class="dropdown-item">Deployments</a>
</li>
                                    
<li>
    <a href="../Changelog/" class="dropdown-item">Changelog</a>
</li>
                                    
<li>
    <a href="../Version-Comparison/" class="dropdown-item">Comparing OTP2 to OTP1</a>
</li>
                                    
<li>
    <a href="../OTP2-MigrationGuide/" class="dropdown-item">OTP2 migration guide</a>
</li>
                                    
<li>
    <a href="../Visual-Identity/" class="dropdown-item">Visual Identity</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Usage <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Basic-Tutorial/" class="dropdown-item">Basic Tutorial</a>
</li>
                                    
<li>
    <a href="../Getting-OTP/" class="dropdown-item">Getting OTP</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Configuration</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../Configuration/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../BuildConfiguration/" class="dropdown-item">Build</a>
</li>
            
<li>
    <a href="../RouterConfiguration/" class="dropdown-item">Router</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../Preparing-OSM/" class="dropdown-item">Preparing OSM Data</a>
</li>
                                    
<li>
    <a href="../Netex-Norway/" class="dropdown-item">Netex and SIRI</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Security</a>
</li>
                                    
<li>
    <a href="../Troubleshooting-Routing/" class="dropdown-item">Troubleshooting</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Development <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Developers-Guide/" class="dropdown-item">Developers' Guide</a>
</li>
                                    
<li>
    <a href="../Interfaces-Data-Sources/" class="dropdown-item">Interfaces and Data Sources</a>
</li>
                                    
<li>
    <a href="../Localization/" class="dropdown-item">Localization</a>
</li>
                                    
<li>
    <a href="../Bibliography/" class="dropdown-item">Bibliography</a>
</li>
                                    
<li>
    <a href="../Codestyle/" class="dropdown-item">Codestyle</a>
</li>
                                    
<li>
    <a href="../SandboxExtension/" class="dropdown-item">Sandbox development</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Sandbox <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../SandboxExtension/" class="dropdown-item">About</a>
</li>
                                    
<li>
    <a href="../sandbox/ActuatorAPI/" class="dropdown-item">Actuator API</a>
</li>
                                    
<li>
    <a href="../sandbox/transferanalyzer/" class="dropdown-item">Direct transfer analyzer</a>
</li>
                                    
<li>
    <a href="../sandbox/GoogleCloudStorage/" class="dropdown-item">Google Cloud Storage</a>
</li>
                                    
<li>
    <a href="../sandbox/LegacyGraphQLApi/" class="dropdown-item">HSL Legacy GraphQL API</a>
</li>
                                    
<li>
    <a href="../sandbox/TransmodelApi/" class="dropdown-item">Transmodel(NeTEx) GraphQL API</a>
</li>
                                    
<li>
    <a href="../sandbox/SiriUpdator/" class="dropdown-item">SIRI Updater</a>
</li>
                                    
<li>
    <a href="../sandbox/VehicleRentalServiceDirectory/" class="dropdown-item">Vehicle Rental Service Directory API support</a>
</li>
                                    
<li>
    <a href="../sandbox/SmooveBikeRental/" class="dropdown-item">Smoove Bike Rental Updator Support</a>
</li>
                                    
<li>
    <a href="../sandbox/MapboxVectorTilesApi/" class="dropdown-item">Mapbox Vector Tiles API</a>
</li>
                                    
<li>
    <a href="../sandbox/Flex/" class="dropdown-item">Flex Routing</a>
</li>
                                    
<li>
    <a href="../sandbox/ReportApi/" class="dropdown-item">Report API</a>
</li>
                                    
<li>
    <a href="../sandbox/InteractiveOtpMain/" class="dropdown-item">Interactive OTP Launcher</a>
</li>
                                    
<li>
    <a href="../sandbox/Examples/" class="dropdown-item">Sandbox Extension Example</a>
</li>
                                    
<li>
    <a href="../sandbox/ParkAndRideApi/" class="dropdown-item">Park and Ride API</a>
</li>
                                    
<li>
    <a href="../sandbox/DataOverlay/" class="dropdown-item">Data Overlay</a>
</li>
                                    
<li>
    <a href="../sandbox/VehicleParking/" class="dropdown-item">Vehicle Parking Updaters</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../Netex-Norway/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Troubleshooting-Routing/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="http://github.com/opentripplanner/OpenTripPlanner/edit/master/docs/Security.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#security" class="nav-link">Security</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#creating-a-keystore" class="nav-link">Creating a keystore</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#testing" class="nav-link">Testing</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#other" class="nav-link">Other</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="security">Security</h1>
<p>OTP's built-in Grizzly web server is configured to accept HTTPS connections on port 8081 by default, but the HTTPS listener needs an encryption key to establish a connection. The key is placed in a "keystore", a format specific to Java server environments. </p>
<h2 id="creating-a-keystore">Creating a keystore</h2>
<p>By default, OTP will look for the keystore at <code>/var/otp/keystore</code>. To generate a self-signed key for testing, use the command:</p>
<pre><code>keytool -genkey -keystore /var/otp/keystore -alias OTPServerKey
</code></pre>
<p>The alias of the key is arbitrary, but it's best to supply one that indicates the purpose of the key to override the default. <code>keytool</code> will ask you a series of questions about you and your organization; again, any values will do when creating this self-signed test key. <code>keytool</code> will also ask you for a password to protect your keystore and key. This password will eventually be configurable, but for now it is hard-coded into the OTP server, so you must set the keystore and key passwords both to <code>opentrip</code>.</p>
<p>Of course with a self-signed key, most clients will (rightfully) refuse to connect without special permission from the user. You'll need to add a security exception to most web browsers, or add the <code>--insecure</code> switch when using CURL. You could theoretically buy and install a "real" trusted SSL/TLS certificate it in the keystore using <code>keytool -gencert</code>, but since none of the functionality protected by this encryption is public-facing a self-signed key should be sufficient for most use cases. All connections to these API methods should be from trusted parties who can verify the validity of the key with you directly as needed.</p>
<h2 id="testing">Testing</h2>
<p>Once you have created a key, start up the OTP server and test that HTTPS access and authentication are possible. You should also be able to fetch any OTP resources over HTTPS. For example, you could simply open <code>https://localhost:8081/index.html</code> in a browser, or open a raw TLS connection using <code>openssl s_client -connect localhost:8081</code>, then issue the request <code>GET index.html HTTP/1.1</code>.</p>
<h2 id="other">Other</h2>
<p>TODO explain CORS, explain adding TLS with reverse proxy e.g. nginx</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../js/version-select.js" defer></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
